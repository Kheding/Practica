<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Reportes de RRHH</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">
    <h2 class="mb-4">Generar Reportes</h2>

    <div class="mb-3">
      <label for="tipoReporte" class="form-label">Seleccionar Tipo de Reporte</label>
      <select id="tipoReporte" class="form-select">
        <option value="solicitudes">Solicitudes</option>
        <option value="documentos">Documentos Subidos</option>
        <option value="incidencias">incidencias</option>
      </select>
    </div>

    <div class="mb-3">
      <label for="formato" class="form-label">Exportar como</label>
      <select id="formato" class="form-select">
        <option value="pdf">PDF</option>
        <option value="docx">Word (DOCX)</option>
        <option value="xlsx">Excel (XLSX)</option>
      </select>
    </div>

    <button class="btn btn-primary" onclick="generarReporte()">Generar Reporte</button>
    <a href="/rrhh/dashboard" class="btn btn-secondary ms-2">Volver</a>
  </div>

  <script>
    async function generarReporte() {
      const tipo = document.getElementById('tipoReporte').value;
      const formato = document.getElementById('formato').value;

      try {
        const res = await fetch(`/rrhh/reportes/exportar/${tipo}/${formato}`, {
          method: 'GET'
        });

        if (!res.ok) throw new Error('Error al generar reporte');

        const blob = await res.blob();
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `reporte_${tipo}.${formato}`;
        a.click();
      } catch (err) {
        alert('Error: ' + err.message);
      }
    }
  </script>
</body>
</html>
