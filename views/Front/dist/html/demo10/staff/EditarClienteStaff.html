<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Editar Cliente</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="container py-4">
    <h2 class="mb-4">Editar Cliente</h2>

    <form id="editarClienteForm" method="POST">
        <div class="row g-3">
            <div class="col-md-6"><label>Nombre</label><input type="text" class="form-control" name="Nombre" required>
            </div>
            <div class="col-md-6"><label>Segundo Nombre</label><input type="text" class="form-control"
                    name="SegundoNombre"></div>
            <div class="col-md-6"><label>Apellido</label><input type="text" class="form-control" name="Apellido"
                    required></div>
            <div class="col-md-6"><label>Segundo Apellido</label><input type="text" class="form-control"
                    name="SegundoApellido"></div>
            <div class="col-md-6"><label>Plan</label><input type="text" class="form-control" name="PlanC" required>
            </div>
            <div class="col-md-6"><label>Fecha Registro</label><input type="date" class="form-control"
                    name="FechaRegistro" required></div>
            <div class="col-md-6"><label>Conversión</label><input type="date" class="form-control" name="Conversion">
            </div>
            <div class="col-md-6"><label>Vencimiento</label><input type="date" class="form-control"
                    name="VencimientoPlan"></div>
            <div class="col-md-6">
                <label>Sede</label>
                <select class="form-select" name="Sede" required>
                    <option value="">Seleccione una sede</option>
                    <option value="NOGALES">NOGALES</option>
                    <option value="COLON">COLON</option>
                    <option value="EL BOSQUE">EL BOSQUE</option>
                    <option value="LA CISTERNA">LA CISTERNA</option>
                    <option value="BUIN">BUIN</option>
                </select>
            </div>
            <div class="col-md-6">
                <label>¿Plan Firmado?</label>
                <select class="form-select" name="PlanFirmado" required>
                    <option value="SI">SI</option>
                    <option value="NO">NO</option>
                </select>
            </div>
            <div class="col-md-6"><label>RUT</label><input type="text" class="form-control" name="RUT"></div>
            <div class="col-md-6"><label>Fecha Nacimiento</label><input type="date" class="form-control"
                    name="FechaNacimiento"></div>
            <div class="col-md-6"><label>Correo Electrónico</label><input type="email" class="form-control"
                    name="CorreoElectronico"></div>
            <div class="col-md-6">
                <label>Género</label>
                <select class="form-select" name="Genero">
                    <option value="">Seleccionar</option>
                    <option value="Masculino">Masculino</option>
                    <option value="Femenino">Femenino</option>
                    <option value="Otro">Otro</option>
                </select>
            </div>
            <div class="col-md-6"><label>Edad</label><input type="number" class="form-control" name="Edad"></div>
            <div class="col-md-6"><label>Teléfono</label><input type="text" class="form-control" name="TelefonoMovil">
            </div>
            <div class="col-md-6"><label>Última Presencia</label><input type="date" class="form-control"
                    name="UltimaPresencia"></div>
            <div class="col-md-6"><label>Valor Plan</label><input type="number" step="0.01" class="form-control"
                    name="ValorPlan"></div>
        </div>

        <div class="mt-4 d-flex justify-content-between">
            <a href="/staff/dashboard" class="btn btn-secondary">Cancelar</a>
            <button type="submit" class="btn btn-primary">Guardar Cambios</button>
        </div>
    </form>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const idCliente = urlParams.get('id');
        const form = document.getElementById('editarClienteForm');

        async function cargarCliente() {
            try {
                const res = await fetch(`/staff/apiEditarCliente/${idCliente}`);
                const data = await res.json();
                Object.keys(data).forEach(key => {
                    const input = form.elements[key];
                    if (input) input.value = data[key];
                });
                form.action = `/staff/apiEditarClientePost/${idCliente}`;
            } catch (error) {
                alert('Error al cargar cliente');
            }
        }

        cargarCliente();
    </script>
</body>

</html>